frontend http-in
    bind *:80
    acl is_api path_beg /api
    acl is_static path_beg /statics
    
    use_backend echoservers if is_api
    use_backend nginxservers if is_static
    timeout client  30s  # Timeout for client-side connections

backend echoservers
    balance roundrobin
    server test-echoserver-1 test-echoserver-1:8080 check
    server test-echoserver-2 test-echoserver-2:8080 check
    server test-echoserver-3 test-echoserver-3:8080 check
    timeout connect  5s  # Timeout for connecting to the backend server
    timeout server   30s  # Timeout for server-side connections

backend nginxservers
    balance uri
    hash-type consistent
    server test-nginx-1 test-nginx-1:80 check
    server test-nginx-2 test-nginx-2:80 check
    server test-nginx-3 test-nginx-3:80 check
    timeout connect  5s  # Timeout for connecting to the backend server
    timeout server   30s  # Timeout for server-side connections
