
defaults
    mode http
    timeout client 10s
    timeout connect 5s
    timeout server 10s
    timeout http-request 10s

frontend http-in
    bind *:80
    use_backend echoservers if { path /api } || { path_beg /api/ }
    use_backend nginxservers if { path /statics } || { path_beg /statics/ }

backend echoservers
    http-request replace-path /api(/)?(.*) /\2
    server echoserver1 echoserver:8080 check
    server echoserver2 echoserver:8080 check
    server echoserver3 echoserver:8080 check

backend nginxservers
    http-request replace-path /statics(/)?(.*) /\2
    server nginx1 nginx:80 check
    server nginx2 nginx:80 check
    server nginx3 nginx:80 check    
